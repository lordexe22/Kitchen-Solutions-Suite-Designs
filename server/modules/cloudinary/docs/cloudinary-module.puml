@startuml
title Cloudinary Module Functional & Architectural View

skinparam componentStyle rectangle
skinparam shadowing false

package "Consumer" {
  [Application Code]
}

package "Cloudinary Module" {

  [cloudinary.ts] <<Facade>>
  [cloudinary.config.ts] <<Config>>
  [cloudinary.utils.ts] <<Internal Helpers>>
  [cloudinary.types.ts] <<Types>>
  [cloudinary.errors.ts] <<Errors>>

  component "createImage()" as create
  component "deleteImage()" as delete
  component "replaceImage()" as replace
  component "renameImage()" as rename
  component "moveImage()" as move
  component "changeImagePrefix()" as prefix
  component "getImage()" as get
  component "listImages()" as list
}

package "Cloudinary SDK v2" {
  [cloudinary.uploader]
  [cloudinary.api]
}

' ==== External Usage ====
[Application Code] --> [cloudinary.ts]

' ==== Facade Delegation ====
[cloudinary.ts] --> create
[cloudinary.ts] --> delete
[cloudinary.ts] --> replace
[cloudinary.ts] --> rename
[cloudinary.ts] --> move
[cloudinary.ts] --> prefix
[cloudinary.ts] --> get
[cloudinary.ts] --> list

' ==== Internal Dependencies ====
create --> [cloudinary.utils.ts]
delete --> [cloudinary.utils.ts]
replace --> [cloudinary.utils.ts]
rename --> [cloudinary.utils.ts]
move --> [cloudinary.utils.ts]
prefix --> [cloudinary.utils.ts]
get --> [cloudinary.utils.ts]
list --> [cloudinary.utils.ts]

create --> [cloudinary.types.ts]
delete --> [cloudinary.types.ts]
replace --> [cloudinary.types.ts]
rename --> [cloudinary.types.ts]
move --> [cloudinary.types.ts]
prefix --> [cloudinary.types.ts]
get --> [cloudinary.types.ts]
list --> [cloudinary.types.ts]

create --> [cloudinary.errors.ts]
delete --> [cloudinary.errors.ts]
replace --> [cloudinary.errors.ts]
rename --> [cloudinary.errors.ts]
move --> [cloudinary.errors.ts]
prefix --> [cloudinary.errors.ts]
get --> [cloudinary.errors.ts]
list --> [cloudinary.errors.ts]

' ==== SDK Usage ====
create --> [cloudinary.uploader]
replace --> [cloudinary.uploader]

delete --> [cloudinary.api]
rename --> [cloudinary.api]
move --> [cloudinary.api]
prefix --> [cloudinary.api]
get --> [cloudinary.api]
list --> [cloudinary.api]

' ==== Source of Truth Rule ====
note right of [cloudinary.api]
All read operations rely on:
api.resource / api.resources
as the single source of truth
end note

note right of [cloudinary.utils.ts]
Responsibilities:
- Input validation
- public_id construction
- Metadata serialization
- Response normalization
end note

note right of [cloudinary.errors.ts]
Typed domain errors:
ValidationError
UploadError
DeleteError
NotFoundError
ReplaceImageError
RenameImageError
MoveImageError
FetchImageError
end note

@enduml
